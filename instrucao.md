 Agora, vamos transformá-la em um "mini Google Drive". Seguirei seu plano, começando pela modernização da interface para um visual mais profissional, usando Bootstrap e ícones via CDN.

  A primeira etapa é atualizar o base.html para incluir esses recursos e criar uma estrutura de layout e navegação mais robusta.
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ ✓  Edit app/templates/base.html: <!doctype html>... => <!doctype html>...                                                                                                                                                                                  │
│                                                                                                                                                                                                                                                            │
│     1   <!doctype html>                                                                                                                                                                                                                                    │
│     2 - <html>                                                                                                                                                                                                                                             │
│     2 + <html lang="en">                                                                                                                                                                                                                                   │
│     3       <head>                                                                                                                                                                                                                                         │
│     4 +       <meta charset="utf-8">                                                                                                                                                                                                                       │
│     5 +       <meta name="viewport" content="width=device-width, initial-scale=1">                                                                                                                                                                         │
│     6         <title>{{ title }} - FileServ</title>                                                                                                                                                                                                        │
│     7 +       <!-- Bootstrap CSS -->                                                                                                                                                                                                                       │
│     8 +       <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">                           │
│     9 +       <!-- Bootstrap Icons -->                                                                                                                                                                                                                     │
│    10 +       <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">                                                                                                                              │
│    11 +       <!-- Local CSS -->                                                                                                                                                                                                                           │
│    12         <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">                                                                                                                                                             │
│    13       </head>                                                                                                                                                                                                                                        │
│     7 -     <body>                                                                                                                                                                                                                                         │
│     8 -         <div>                                                                                                                                                                                                                                      │
│     9 -             FileServ:                                                                                                                                                                                                                              │
│    10 -             <a href="{{ url_for('main.index') }}">Home</a>                                                                                                                                                                                         │
│    14 +     <body class="bg-light">                                                                                                                                                                                                                        │
│    15 +         <nav class="navbar navbar-expand-lg navbar-dark bg-dark">                                                                                                                                                                                  │
│    16 +             <div class="container-fluid">                                                                                                                                                                                                          │
│    17 +                 <a class="navbar-brand" href="{{ url_for('main.index') }}">                                                                                                                                                                        │
│    18 +                     <i class="bi bi-hdd-stack"></i>                                                                                                                                                                                                │
│    19 +                     FileServ                                                                                                                                                                                                                       │
│    20 +                 </a>                                                                                                                                                                                                                               │
│    21 +                 <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">                                                 │
│    22 +                     <span class="navbar-toggler-icon"></span>                                                                                                                                                                                      │
│    23 +                 </button>                                                                                                                                                                                                                          │
│    24 +                 <div class="collapse navbar-collapse" id="navbarNav">                                                                                                                                                                              │
│    25 +                     <ul class="navbar-nav ms-auto">                                                                                                                                                                                                │
│    26                           {% if current_user.is_anonymous %}                                                                                                                                                                                         │
│    12 -             <a href="{{ url_for('auth.login') }}">Login</a>                                                                                                                                                                                        │
│    ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ │
│    27 +                         <li class="nav-item">                                                                                                                                                                                                      │
│    28 +                             <a class="nav-link" href="{{ url_for('auth.login') }}">Login</a>                                                                                                                                                       │
│    29 +                         </li>                                                                                                                                                                                                                      │
│    30                           {% else %}                                                                                                                                                                                                                 │
│    14 -             <a href="{{ url_for('auth.logout') }}">Logout</a>                                                                                                                                                                                      │
│    ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ │
│    31 +                         <li class="nav-item">                                                                                                                                                                                                      │
│    32 +                             <a class="nav-link" href="#">                                                                                                                                                                                          │
│    33 +                                 <i class="bi bi-person-circle"></i>                                                                                                                                                                                │
│    34 +                                 {{ current_user.username }}                                                                                                                                                                                        │
│    35 +                             </a>                                                                                                                                                                                                                   │
│    36 +                         </li>                                                                                                                                                                                                                      │
│    37 +                         <li class="nav-item">                                                                                                                                                                                                      │
│    38 +                             <a class="nav-link" href="{{ url_for('auth.logout') }}">                                                                                                                                                               │
│    39 +                                 <i class="bi bi-box-arrow-right"></i>                                                                                                                                                                              │
│    40 +                                 Logout                                                                                                                                                                                                             │
│    41 +                             </a>                                                                                                                                                                                                                   │
│    42 +                         </li>                                                                                                                                                                                                                      │
│    43                           {% endif %}                                                                                                                                                                                                                │
│    44 +                     </ul>                                                                                                                                                                                                                          │
│    45                   </div>                                                                                                                                                                                                                             │
│    17 -         <hr>                                                                                                                                                                                                                                       │
│    18 -         {% with messages = get_flashed_messages() %}                                                                                                                                                                                               │
│    ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ │
│    46 +             </div>                                                                                                                                                                                                                                 │
│    47 +         </nav>                                                                                                                                                                                                                                     │
│    48 +                                                                                                                                                                                                                                                    │
│    49 +         <main class="container mt-4">                                                                                                                                                                                                              │
│    50 +             {% with messages = get_flashed_messages(with_categories=true) %}                                                                                                                                                                       │
│    51               {% if messages %}                                                                                                                                                                                                                      │
│    20 -         <ul>                                                                                                                                                                                                                                       │
│    21 -             {% for message in messages %}                                                                                                                                                                                                          │
│    22 -             <li>{{ message }}</li>                                                                                                                                                                                                                 │
│    ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ │
│    52 +                 {% for category, message in messages %}                                                                                                                                                                                            │
│    53 +                 <div class="alert alert-{{ category or 'info' }} alert-dismissible fade show" role="alert">                                                                                                                                        │
│    54 +                     {{ message }}                                                                                                                                                                                                                  │
│    55 +                     <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>                                                                                                                                   │
│    56 +                 </div>                                                                                                                                                                                                                             │
│    57                   {% endfor %}                                                                                                                                                                                                                       │
│    24 -         </ul>                                                                                                                                                                                                                                      │
│    ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ │
│    58               {% endif %}                                                                                                                                                                                                                            │
│    59               {% endwith %}                                                                                                                                                                                                                          │
│    60 +                                                                                                                                                                                                                                                    │
│    61               {% block content %}{% endblock %}                                                                                                                                                                                                      │
│    62 +         </main>                                                                                                                                                                                                                                    │
│    63 +                                                                                                                                                                                                                                                    │
│    64 +         <!-- Bootstrap JS -->                                                                                                                                                                                                                      │
│    65 +         <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>                           │
│    66 +         <!-- Local JS -->                                                                                                                                                                                                                          │
│    67           <script src="{{ url_for('static', filename='js/main.js') }}"></script>                                                                                                                                                                     │
│    68       </body>                                                                                                                                                                                                                                        │
│    69   </html>                                                                                                                                                                                                                                            │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
✦ base.html atualizado. Agora, vou aplicar o Bootstrap aos templates login.html, register.html e index.html para profissionalizar os formulários e a estrutura. O index.html se tornará o painel principal, com botões de ação e um espaço para a lista de
  arquivos. Também limparei o style.css para complementar o Bootstrap. Começando pelo login.html.
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ ✓  Edit app/templates/login.html: {% extends "base.html" %}... => {% extends "base.html" %}...                                                                                                                                                             │
│                                                                                                                                                                                                                                                            │
│     1   {% extends "base.html" %}                                                                                                                                                                                                                          │
│     2                                                                                                                                                                                                                                                      │
│     3   {% block content %}                                                                                                                                                                                                                                │
│     4 -     <h1>Sign In</h1>                                                                                                                                                                                                                               │
│     4 + <div class="row justify-content-center">                                                                                                                                                                                                           │
│     5 +     <div class="col-md-6 col-lg-4">                                                                                                                                                                                                                │
│     6 +         <div class="card">                                                                                                                                                                                                                         │
│     7 +             <div class="card-body">                                                                                                                                                                                                                │
│     8 +                 <h3 class="card-title text-center">Sign In</h3>                                                                                                                                                                                    │
│     9                   <form action="" method="post" novalidate>                                                                                                                                                                                          │
│    10                       {{ form.hidden_tag() }}                                                                                                                                                                                                        │
│     7 -         <p>                                                                                                                                                                                                                                        │
│     8 -             {{ form.username.label }}<br>                                                                                                                                                                                                          │
│     9 -             {{ form.username(size=32) }}<br>                                                                                                                                                                                                       │
│    11 +                     <div class="mb-3">                                                                                                                                                                                                             │
│    12 +                         {{ form.username.label(class="form-label") }}<br>                                                                                                                                                                          │
│    13 +                         {{ form.username(class="form-control", size=32) }}                                                                                                                                                                         │
│    14                           {% for error in form.username.errors %}                                                                                                                                                                                    │
│    11 -             <span style="color: red;">[{{ error }}]</span>                                                                                                                                                                                         │
│    15 +                         <div class="invalid-feedback d-block">{{ error }}</div>                                                                                                                                                                    │
│    16                           {% endfor %}                                                                                                                                                                                                               │
│    13 -         </p>                                                                                                                                                                                                                                       │
│    14 -         <p>                                                                                                                                                                                                                                        │
│    15 -             {{ form.password.label }}<br>                                                                                                                                                                                                          │
│    16 -             {{ form.password(size=32) }}<br>                                                                                                                                                                                                       │
│    17 +                     </div>                                                                                                                                                                                                                         │
│    18 +                     <div class="mb-3">                                                                                                                                                                                                             │
│    19 +                         {{ form.password.label(class="form-label") }}<br>                                                                                                                                                                          │
│    20 +                         {{ form.password(class="form-control", size=32) }}                                                                                                                                                                         │
│    21                           {% for error in form.password.errors %}                                                                                                                                                                                    │
│    18 -             <span style="color: red;">[{{ error }}]</span>                                                                                                                                                                                         │
│    22 +                         <div class="invalid-feedback d-block">{{ error }}</div>                                                                                                                                                                    │
│    23                           {% endfor %}                                                                                                                                                                                                               │
│    20 -         </p>                                                                                                                                                                                                                                       │
│    21 -         <p>{{ form.remember_me() }} {{ form.remember_me.label }}</p>                                                                                                                                                                               │
│    22 -         <p>{{ form.submit() }}</p>                                                                                                                                                                                                                 │
│    24 +                     </div>                                                                                                                                                                                                                         │
│    25 +                     <div class="mb-3 form-check">                                                                                                                                                                                                  │
│    26 +                         {{ form.remember_me(class="form-check-input") }}                                                                                                                                                                           │
│    27 +                         {{ form.remember_me.label(class="form-check-label") }}                                                                                                                                                                     │
│    28 +                     </div>                                                                                                                                                                                                                         │
│    29 +                     <div class="d-grid">                                                                                                                                                                                                           │
│    30 +                         {{ form.submit(class="btn btn-primary") }}                                                                                                                                                                                 │
│    31 +                     </div>                                                                                                                                                                                                                         │
│    32                   </form>                                                                                                                                                                                                                            │
│    24 -     <p>New User? <a href="{{ url_for('auth.register') }}">Click to Register!</a></p>                                                                                                                                                               │
│    ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ │
│    33 +                 <p class="mt-3 text-center">New User? <a href="{{ url_for('auth.register') }}">Click to Register!</a></p>                                                                                                                          │
│    34 +             </div>                                                                                                                                                                                                                                 │
│    35 +         </div>                                                                                                                                                                                                                                     │
│    36 +     </div>                                                                                                                                                                                                                                         │
│    37 + </div>                                                                                                                                                                                                                                             │
│    38   {% endblock %}                                                                                                                                                                                                                                     │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
✦ login.html atualizado. Agora, vou estilizar register.html com o mesmo Bootstrap.
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ ✓  Edit app/templates/register.html: {% extends "base.html" %}... => {% extends "base.html" %}...                                                                                                                                                          │
│                                                                                                                                                                                                                                                            │
│     1   {% extends "base.html" %}                                                                                                                                                                                                                          │
│     2                                                                                                                                                                                                                                                      │
│     3   {% block content %}                                                                                                                                                                                                                                │
│     4 -     <h1>Register</h1>                                                                                                                                                                                                                              │
│     4 + <div class="row justify-content-center">                                                                                                                                                                                                           │
│     5 +     <div class="col-md-6 col-lg-4">                                                                                                                                                                                                                │
│     6 +         <div class="card">                                                                                                                                                                                                                         │
│     7 +             <div class="card-body">                                                                                                                                                                                                                │
│     8 +                 <h3 class="card-title text-center">Register</h3>                                                                                                                                                                                   │
│     9                   <form action="" method="post">                                                                                                                                                                                                     │
│    10                       {{ form.hidden_tag() }}                                                                                                                                                                                                        │
│     7 -         <p>                                                                                                                                                                                                                                        │
│     8 -             {{ form.username.label }}<br>                                                                                                                                                                                                          │
│     9 -             {{ form.username(size=32) }}<br>                                                                                                                                                                                                       │
│    11 +                     <div class="mb-3">                                                                                                                                                                                                             │
│    12 +                         {{ form.username.label(class="form-label") }}<br>                                                                                                                                                                          │
│    13 +                         {{ form.username(class="form-control", size=32) }}                                                                                                                                                                         │
│    14                           {% for error in form.username.errors %}                                                                                                                                                                                    │
│    11 -             <span style="color: red;">[{{ error }}]</span>                                                                                                                                                                                         │
│    15 +                         <div class="invalid-feedback d-block">{{ error }}</div>                                                                                                                                                                    │
│    16                           {% endfor %}                                                                                                                                                                                                               │
│    13 -         </p>                                                                                                                                                                                                                                       │
│    14 -         <p>                                                                                                                                                                                                                                        │
│    15 -             {{ form.password.label }}<br>                                                                                                                                                                                                          │
│    16 -             {{ form.password(size=32) }}<br>                                                                                                                                                                                                       │
│    17 +                     </div>                                                                                                                                                                                                                         │
│    18 +                     <div class="mb-3">                                                                                                                                                                                                             │
│    19 +                         {{ form.password.label(class="form-label") }}<br>                                                                                                                                                                          │
│    20 +                         {{ form.password(class="form-control", size=32) }}                                                                                                                                                                         │
│    21                           {% for error in form.password.errors %}                                                                                                                                                                                    │
│    18 -             <span style="color: red;">[{{ error }}]</span>                                                                                                                                                                                         │
│    22 +                         <div class="invalid-feedback d-block">{{ error }}</div>                                                                                                                                                                    │
│    23                           {% endfor %}                                                                                                                                                                                                               │
│    20 -         </p>                                                                                                                                                                                                                                       │
│    21 -         <p>                                                                                                                                                                                                                                        │
│    22 -             {{ form.password2.label }}<br>                                                                                                                                                                                                         │
│    23 -             {{ form.password2(size=32) }}<br>                                                                                                                                                                                                      │
│    24 +                     </div>                                                                                                                                                                                                                         │
│    25 +                     <div class="mb-3">                                                                                                                                                                                                             │
│    26 +                         {{ form.password2.label(class="form-label") }}<br>                                                                                                                                                                         │
│    27 +                         {{ form.password2(class="form-control", size=32) }}                                                                                                                                                                        │
│    28                           {% for error in form.password2.errors %}                                                                                                                                                                                   │
│    25 -             <span style="color: red;">[{{ error }}]</span>                                                                                                                                                                                         │
│    29 +                         <div class="invalid-feedback d-block">{{ error }}</div>                                                                                                                                                                    │
│    30                           {% endfor %}                                                                                                                                                                                                               │
│    27 -         </p>                                                                                                                                                                                                                                       │
│    28 -         <p>{{ form.submit() }}</p>                                                                                                                                                                                                                 │
│    31 +                     </div>                                                                                                                                                                                                                         │
│    32 +                     <div class="d-grid">                                                                                                                                                                                                           │
│    33 +                         {{ form.submit(class="btn btn-primary") }}                                                                                                                                                                                 │
│    34 +                     </div>                                                                                                                                                                                                                         │
│    35                   </form>                                                                                                                                                                                                                            │
│    36 +                  <p class="mt-3 text-center">Already have an account? <a href="{{ url_for('auth.login') }}">Login here!</a></p>                                                                                                                    │
│    37 +             </div>                                                                                                                                                                                                                                 │
│    38 +         </div>                                                                                                                                                                                                                                     │
│    39 +     </div>                                                                                                                                                                                                                                         │
│    40 + </div>                                                                                                                                                                                                                                             │
│    41   {% endblock %}                                                                                                                                                                                                                                     │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
✦ Login e registro atualizados. Agora, vou modificar o index.html para ser o painel de arquivos, adicionando uma barra de ferramentas com botões de "Upload" e "Nova Pasta", e uma tabela para listar os arquivos. Também ajustarei o style.css para melhorar a
  aparência dos ícones e do layout.
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ ✓  Edit app/templates/index.html: {% extends "base.html" %}... => {% extends "base.html" %}...                                                                                                                                                             │
│                                                                                                                                                                                                                                                            │
│     1   {% extends "base.html" %}                                                                                                                                                                                                                          │
│     2                                                                                                                                                                                                                                                      │
│     3   {% block content %}                                                                                                                                                                                                                                │
│     4 -     <h1>Hi, {{ current_user.username }}!</h1>                                                                                                                                                                                                      │
│     5 -     <p>Welcome to your FileServ dashboard.</p>                                                                                                                                                                                                     │
│     4 +     <div class="d-flex justify-content-between align-items-center mb-4">                                                                                                                                                                           │
│     5 +         <h2 class="h4">My Files</h2>                                                                                                                                                                                                               │
│     6 +         <div>                                                                                                                                                                                                                                      │
│     7 +             <button class="btn btn-primary me-2" type="button">                                                                                                                                                                                    │
│     8 +                 <i class="bi bi-cloud-arrow-up-fill me-1"></i> Upload File                                                                                                                                                                         │
│     9 +             </button>                                                                                                                                                                                                                              │
│    10 +             <button class="btn btn-outline-secondary" type="button">                                                                                                                                                                               │
│    11 +                 <i class="bi bi-folder-plus me-1"></i> New Folder                                                                                                                                                                                  │
│    12 +             </button>                                                                                                                                                                                                                              │
│    13 +         </div>                                                                                                                                                                                                                                     │
│    14 +     </div>                                                                                                                                                                                                                                         │
│    15 +                                                                                                                                                                                                                                                    │
│    16 +     <div class="card">                                                                                                                                                                                                                             │
│    17 +         <div class="card-body">                                                                                                                                                                                                                    │
│    18 +             <table class="table table-hover">                                                                                                                                                                                                      │
│    19 +                 <thead>                                                                                                                                                                                                                            │
│    20 +                     <tr>                                                                                                                                                                                                                           │
│    21 +                         <th scope="col">Name</th>                                                                                                                                                                                                  │
│    22 +                         <th scope="col">Type</th>                                                                                                                                                                                                  │
│    23 +                         <th scope="col">Date Modified</th>                                                                                                                                                                                         │
│    24 +                         <th scope="col">Actions</th>                                                                                                                                                                                               │
│    25 +                     </tr>                                                                                                                                                                                                                          │
│    26 +                 </thead>                                                                                                                                                                                                                           │
│    27 +                 <tbody id="file-list">                                                                                                                                                                                                             │
│    28 +                     <!-- File and folder list will be dynamically inserted here by JavaScript -->                                                                                                                                                  │
│    29 +                     <tr>                                                                                                                                                                                                                           │
│    30 +                         <td colspan="4" class="text-center text-muted">Loading files...</td>                                                                                                                                                       │
│    31 +                     </tr>                                                                                                                                                                                                                          │
│    32 +                 </tbody>                                                                                                                                                                                                                           │
│    33 +             </table>                                                                                                                                                                                                                               │
│    34 +         </div>                                                                                                                                                                                                                                     │
│    35 +     </div>                                                                                                                                                                                                                                         │
│    36   {% endblock %}                                                                                                                                                                                                                                     │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
✦ index.html atualizado. Agora, vou ajustar o style.css para complementar o novo design do Bootstrap e adicionar estilos personalizados para a lista de arquivos.
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ ✓  Edit app/static/css/style.css: body {... => /* General body style to compl...                                                                                                                                                                           │
│                                                                                                                                                                                                                                                            │
│     1 + /* General body style to complement Bootstrap */                                                                                                                                                                                                   │
│     2   body {                                                                                                                                                                                                                                             │
│     2 -     font-family: sans-serif;                                                                                                                                                                                                                       │
│     3 -     margin: 2em;                                                                                                                                                                                                                                   │
│     4 -     background-color: #f4f4f4;                                                                                                                                                                                                                     │
│     5 -     color: #333;                                                                                                                                                                                                                                   │
│     3 +     background-color: #f8f9fa;                                                                                                                                                                                                                     │
│     4   }                                                                                                                                                                                                                                                  │
│     5                                                                                                                                                                                                                                                      │
│     8 - div {                                                                                                                                                                                                                                              │
│     9 -     padding: 5px;                                                                                                                                                                                                                                  │
│    10 - }                                                                                                                                                                                                                                                  │
│    11 -                                                                                                                                                                                                                                                    │
│    12 - a {                                                                                                                                                                                                                                                │
│    13 -     color: #007bff;                                                                                                                                                                                                                                │
│    14 -     text-decoration: none;                                                                                                                                                                                                                         │
│    15 - }                                                                                                                                                                                                                                                  │
│    16 -                                                                                                                                                                                                                                                    │
│    17 - form p {                                                                                                                                                                                                                                           │
│    18 -     margin-bottom: 1em;                                                                                                                                                                                                                            │
│    19 - }                                                                                                                                                                                                                                                  │
│    20 -                                                                                                                                                                                                                                                    │
│    21 - input[type="text"], input[type="password"] {                                                                                                                                                                                                       │
│    22 -     padding: 8px;                                                                                                                                                                                                                                  │
│    23 -     border: 1px solid #ccc;                                                                                                                                                                                                                        │
│    24 -     border-radius: 4px;                                                                                                                                                                                                                            │
│    25 - }                                                                                                                                                                                                                                                  │
│    26 -                                                                                                                                                                                                                                                    │
│    27 - input[type="submit"] {                                                                                                                                                                                                                             │
│    28 -     padding: 10px 15px;                                                                                                                                                                                                                            │
│    29 -     border: none;                                                                                                                                                                                                                                  │
│    30 -     border-radius: 4px;                                                                                                                                                                                                                            │
│    31 -     background-color: #007bff;                                                                                                                                                                                                                     │
│    32 -     color: white;                                                                                                                                                                                                                                  │
│     6 + /* Add hover effect to file list table */                                                                                                                                                                                                          │
│     7 + .table-hover tbody tr:hover {                                                                                                                                                                                                                      │
│     8 +     background-color: #f1f1f1;                                                                                                                                                                                                                     │
│     9       cursor: pointer;                                                                                                                                                                                                                               │
│    10   }                                                                                                                                                                                                                                                  │
│    11                                                                                                                                                                                                                                                      │
│    ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ │
│    36 - input[type="submit"]:hover {                                                                                                                                                                                                                       │
│    37 -     background-color: #0056b3;                                                                                                                                                                                                                     │
│    12 + /* Style for file/folder icons */                                                                                                                                                                                                                  │
│    13 + .file-icon {                                                                                                                                                                                                                                       │
│    14 +     font-size: 1.2rem;                                                                                                                                                                                                                             │
│    15 +     margin-right: 10px;                                                                                                                                                                                                                            │
│    16   }                                                                                                                                                                                                                                                  │
│    ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ │
│    39 -                                                                                                                                                                                                                                                    │
│    40 - .flash {                                                                                                                                                                                                                                           │
│    41 -     list-style: none;                                                                                                                                                                                                                              │
│    42 -     padding: 10px;                                                                                                                                                                                                                                 │
│    43 -     margin-bottom: 1em;                                                                                                                                                                                                                            │
│    44 -     border-radius: 4px;                                                                                                                                                                                                                            │
│    45 -     background-color: #d1ecf1;                                                                                                                                                                                                                     │
│    46 -     color: #0c5460;                                                                                                                                                                                                                                │
│    47 -     border: 1px solid #bee5eb;                                                                                                                                                                                                                     │
│    48 - }                                                                                                                                                                                                                                                  │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
✦ Templates e estilos atualizados. Agora, vou implementar o backend para manipulação de arquivos e pastas. Primeiro, atualizarei o models.py com um novo modelo File para metadados, incluindo hierarquia de pastas. Em seguida, criarei um novo Blueprint em
  app/routes/files.py e implementarei o endpoint GET /api/files para listar arquivos e pastas do usuário. Finalmente, registrarei o novo blueprint no app/__init__.py. Começando pela atualização do models.py.
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ ✓  Edit app/models.py: from app import db, login, pwd... => from app import db, login, pwd...                                                                                                                                                              │
│                                                                                                                                                                                                                                                            │
│     1   from app import db, login, pwd_context                                                                                                                                                                                                             │
│     2   from flask_login import UserMixin                                                                                                                                                                                                                  │
│     3 + from datetime import datetime                                                                                                                                                                                                                      │
│     4                                                                                                                                                                                                                                                      │
│     5   @login.user_loader                                                                                                                                                                                                                                 │
│     6   def load_user(id):                                                                                                                                                                                                                                 │
│    ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ │
│    18       username = db.Column(db.String(64), index=True, unique=True)                                                                                                                                                                                   │
│    19       password_hash = db.Column(db.String(128))                                                                                                                                                                                                      │
│    20       role_id = db.Column(db.Integer, db.ForeignKey('roles.id'))                                                                                                                                                                                     │
│    21 +     files = db.relationship('File', backref='owner', lazy='dynamic')                                                                                                                                                                               │
│    22                                                                                                                                                                                                                                                      │
│    23       def set_password(self, password):                                                                                                                                                                                                              │
│    24           self.password_hash = pwd_context.hash(password)                                                                                                                                                                                            │
│    25                                                                                                                                                                                                                                                      │
│    26       def check_password(self, password):                                                                                                                                                                                                            │
│    27           return pwd_context.verify(password, self.password_hash)                                                                                                                                                                                    │
│    28 +                                                                                                                                                                                                                                                    │
│    29 + class File(db.Model):                                                                                                                                                                                                                              │
│    30 +     __tablename__ = 'files'                                                                                                                                                                                                                        │
│    31 +     id = db.Column(db.Integer, primary_key=True)                                                                                                                                                                                                   │
│    32 +     filename = db.Column(db.String(255), nullable=False)                                                                                                                                                                                           │
│    33 +     is_folder = db.Column(db.Boolean, default=False, nullable=False)                                                                                                                                                                               │
│    34 +     created_at = db.Column(db.DateTime, default=datetime.utcnow)                                                                                                                                                                                   │
│    35 +     owner_id = db.Column(db.Integer, db.ForeignKey('users.id'), nullable=False)                                                                                                                                                                    │
│    36 +     parent_id = db.Column(db.Integer, db.ForeignKey('files.id'), nullable=True)                                                                                                                                                                    │
│    37 +     children = db.relationship('File', backref=db.backref('parent', remote_side=[id]), lazy='dynamic')                                                                                                                                             │
│    38 +                                                                                                                                                                                                                                                    │
│    39 +     def to_dict(self):                                                                                                                                                                                                                             │
│    40 +         return {                                                                                                                                                                                                                                   │
│    41 +             'id': self.id,                                                                                                                                                                                                                         │
│    42 +             'filename': self.filename,                                                                                                                                                                                                             │
│    43 +             'is_folder': self.is_folder,                                                                                                                                                                                                           │
│    44 +             'created_at': self.created_at.isoformat() + 'Z',                                                                                                                                                                                       │
│    45 +             'parent_id': self.parent_id                                                                                                                                                                                                            │
│    46 +         }                                                                                                                                                                                                                                          │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
✦ models.py atualizado. Agora, criarei o blueprint de arquivos em app/routes/files.py, definindo o endpoint GET /api/files para listar arquivos e pastas com base no parent_id e no usuário logado. Em seguida, registrarei o novo blueprint no app/__init__.py
  sob o prefixo /api. Começando pela criação do arquivo de rotas.
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ ✓  WriteFile Writing to app/routes/files.py                                                                                                                                                                                                                │
│                                                                                                                                                                                                                                                            │
│     1 from flask import Blueprint, jsonify, request                                                                                                                                                                                                        │
│     2 from flask_login import login_required, current_user                                                                                                                                                                                                 │
│     3 from app.models import File                                                                                                                                                                                                                          │
│     4 from app import db                                                                                                                                                                                                                                   │
│     5                                                                                                                                                                                                                                                      │
│     6 bp = Blueprint('files', __name__)                                                                                                                                                                                                                    │
│     7                                                                                                                                                                                                                                                      │
│     8 @bp.route('/files', methods=['GET'])                                                                                                                                                                                                                 │
│     9 @login_required                                                                                                                                                                                                                                      │
│    10 def list_files():                                                                                                                                                                                                                                    │
│    11     parent_id = request.args.get('parent_id', default=None, type=int)                                                                                                                                                                                │
│    12                                                                                                                                                                                                                                                      │
│    13     # Query for files and folders in the specified directory for the current user                                                                                                                                                                    │
│    14     query = File.query.filter_by(owner_id=current_user.id, parent_id=parent_id).order_by(File.is_folder.desc(), File.filename.asc())                                                                                                                 │
│    15                                                                                                                                                                                                                                                      │
│    16     items = [item.to_dict() for item in query.all()]                                                                                                                                                                                                 │
│    17                                                                                                                                                                                                                                                      │
│    18     return jsonify(items)                                                                                                                                                                                                                            │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
✦ Criei o blueprint files.py e o endpoint list_files. Agora, vou registrá-lo na factory principal em app/__init__.py.
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ ✓  Edit app/__init__.py:     from app.routes.auth impor... =>     from app.routes.auth impor...                                                                                                                                                            │
│                                                                                                                                                                                                                                                            │
│    22   from app.routes.auth import bp as auth_bp                                                                                                                                                                                                          │
│    23   app.register_blueprint(auth_bp, url_prefix='/auth')                                                                                                                                                                                                │
│    24                                                                                                                                                                                                                                                      │
│    25 + from app.routes.files import bp as files_bp                                                                                                                                                                                                        │
│    26 + app.register_blueprint(files_bp, url_prefix='/api')                                                                                                                                                                                                │
│    27 +                                                                                                                                                                                                                                                    │
│    28   from app.routes.main import bp as main_bp                                                                                                                                                                                                          │
│    29   app.register_blueprint(main_bp)                                                                                                                                                                                                                    │
│    30                                                                                                                                                                                                                                                      │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
✦ Criei o endpoint da API. Agora, no main.js, vou criar a função fetchAndRenderFiles para, ao carregar a página, buscar dados em /api/files e renderizá-los dinamicamente como linhas em uma tabela no index.html, exibindo ícone, nome, tipo e data de cada
  item. Adicionarei um event listener para garantir que a função seja chamada quando o DOM estiver pronto.
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ ✓  Edit app/static/js/main.js: // Future JavaScript can go he... => document.addEventListener('DOM...                                                                                                                                                      │
│                                                                                                                                                                                                                                                            │
│     1 - // Future JavaScript can go here.                                                                                                                                                                                                                  │
│     1 + document.addEventListener('DOMContentLoaded', function () {                                                                                                                                                                                        │
│     2 +     const fileListBody = document.getElementById('file-list');                                                                                                                                                                                     │
│     3 +                                                                                                                                                                                                                                                    │
│     4 +     async function fetchAndRenderFiles(parentId = null) {                                                                                                                                                                                          │
│     5 +         // Clear current list and show loading indicator                                                                                                                                                                                           │
│     6 +         fileListBody.innerHTML = '<tr><td colspan="4" class="text-center text-muted">Loading files...</td></tr>';                                                                                                                                  │
│     7 +                                                                                                                                                                                                                                                    │
│     8 +         try {                                                                                                                                                                                                                                      │
│     9 +             let url = '/api/files';                                                                                                                                                                                                                │
│    10 +             if (parentId) {                                                                                                                                                                                                                        │
│    11 +                 url += `?parent_id=${parentId}`;                                                                                                                                                                                                   │
│    12 +             }                                                                                                                                                                                                                                      │
│    13 +                                                                                                                                                                                                                                                    │
│    14 +             const response = await fetch(url);                                                                                                                                                                                                     │
│    15 +             if (!response.ok) {                                                                                                                                                                                                                    │
│    16 +                 throw new Error(`HTTP error! status: ${response.status}`);                                                                                                                                                                         │
│    17 +             }                                                                                                                                                                                                                                      │
│    18 +             const files = await response.json();                                                                                                                                                                                                   │
│    19 +                                                                                                                                                                                                                                                    │
│    20 +             // Clear loading indicator                                                                                                                                                                                                             │
│    21 +             fileListBody.innerHTML = '';                                                                                                                                                                                                           │
│    22 +                                                                                                                                                                                                                                                    │
│    23 +             if (files.length === 0) {                                                                                                                                                                                                              │
│    24 +                 fileListBody.innerHTML = '<tr><td colspan="4" class="text-center text-muted">This folder is empty.</td></tr>';                                                                                                                     │
│    25 +             }                                                                                                                                                                                                                                      │
│    26 +                                                                                                                                                                                                                                                    │
│    27 +             files.forEach(file => {                                                                                                                                                                                                                │
│    28 +                 const row = document.createElement('tr');                                                                                                                                                                                          │
│    29 +                                                                                                                                                                                                                                                    │
│    30 +                 const iconClass = file.is_folder ? 'bi-folder-fill' : 'bi-file-earmark';                                                                                                                                                           │
│    31 +                 const fileType = file.is_folder ? 'Folder' : 'File';                                                                                                                                                                               │
│    32 +                 const date = new Date(file.created_at).toLocaleDateString();                                                                                                                                                                       │
│    33 +                                                                                                                                                                                                                                                    │
│    34 +                 row.innerHTML = `                                                                                                                                                                                                                  │
│    35 +                     <td>                                                                                                                                                                                                                           │
│    36 +                         <i class="bi ${iconClass} file-icon"></i>                                                                                                                                                                                  │
│    37 +                         ${file.filename}                                                                                                                                                                                                           │
│    38 +                     </td>                                                                                                                                                                                                                          │
│    39 +                     <td>${fileType}</td>                                                                                                                                                                                                           │
│    40 +                     <td>${date}</td>                                                                                                                                                                                                               │
│    41 +                     <td>                                                                                                                                                                                                                           │
│    42 +                         <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-download"></i></button>                                                                                                                                   │
│    43 +                         <button class="btn btn-sm btn-outline-danger"><i class="bi bi-trash"></i></button>                                                                                                                                         │
│    44 +                     </td>                                                                                                                                                                                                                          │
│    45 +                 `;                                                                                                                                                                                                                                 │
│    46 +                 fileListBody.appendChild(row);                                                                                                                                                                                                     │
│    47 +             });                                                                                                                                                                                                                                    │
│    48 +         } catch (error) {                                                                                                                                                                                                                          │
│    49 +             console.error('Failed to fetch files:', error);                                                                                                                                                                                        │
│    50 +             fileListBody.innerHTML = '<tr><td colspan="4" class="text-center text-danger">Failed to load files.</td></tr>';                                                                                                                        │
│    51 +         }                                                                                                                                                                                                                                          │
│    52 +     }                                                                                                                                                                                                                                              │
│    53 +                                                                                                                                                                                                                                                    │
│    54 +     // Initial fetch for root directory                                                                                                                                                                                                            │
│    55 +     fetchAndRenderFiles();                                                                                                                                                                                                                         │
│    56 + });                                                                                                                                                                                                                                                │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
✦ O JavaScript para buscar e exibir arquivos foi implementado. Agora, vou adicionar a funcionalidade de "Upload de Arquivo". Primeiro, adicionarei um modal Bootstrap oculto ao index.html com um formulário de upload. Em seguida, criarei o endpoint POST
  /api/files/upload no backend para salvar o arquivo em um diretório dedicado e registrar no banco de dados. Finalmente, atualizarei o main.js para exibir o modal, enviar o arquivo via fetch e atualizar a lista de arquivos após o upload. Começarei
  adicionando o modal ao index.html.
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ ✓  Edit app/templates/index.html: {% extends "base.html" %}... => {% extends "base.html" %}...                                                                                                                                                             │
│                                                                                                                                                                                                                                                            │
│     4       <div class="d-flex justify-content-between align-items-center mb-4">                                                                                                                                                                           │
│     5           <h2 class="h4">My Files</h2>                                                                                                                                                                                                               │
│     6           <div>                                                                                                                                                                                                                                      │
│     7 -             <button class="btn btn-primary me-2" type="button">                                                                                                                                                                                    │
│     7 +             <button class="btn btn-primary me-2" type="button" data-bs-toggle="modal" data-bs-target="#uploadModal">                                                                                                                               │
│     8                   <i class="bi bi-cloud-arrow-up-fill me-1"></i> Upload File                                                                                                                                                                         │
│     9               </button>                                                                                                                                                                                                                              │
│    10               <button class="btn btn-outline-secondary" type="button">                                                                                                                                                                               │
│    ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ │
│    33               </table>                                                                                                                                                                                                                               │
│    34           </div>                                                                                                                                                                                                                                     │
│    35       </div>                                                                                                                                                                                                                                         │
│    36 +                                                                                                                                                                                                                                                    │
│    37 + <!-- Upload Modal -->                                                                                                                                                                                                                              │
│    38 + <div class="modal fade" id="uploadModal" tabindex="-1" aria-labelledby="uploadModalLabel" aria-hidden="true">                                                                                                                                      │
│    39 +   <div class="modal-dialog">                                                                                                                                                                                                                       │
│    40 +     <div class="modal-content">                                                                                                                                                                                                                    │
│    41 +       <div class="modal-header">                                                                                                                                                                                                                   │
│    42 +         <h5 class="modal-title" id="uploadModalLabel">Upload File</h5>                                                                                                                                                                             │
│    43 +         <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>                                                                                                                                               │
│    44 +       </div>                                                                                                                                                                                                                                       │
│    45 +       <div class="modal-body">                                                                                                                                                                                                                     │
│    46 +         <form id="upload-form">                                                                                                                                                                                                                    │
│    47 +           <div class="mb-3">                                                                                                                                                                                                                       │
│    48 +             <label for="file-input" class="form-label">Select a file</label>                                                                                                                                                                       │
│    49 +             <input class="form-control" type="file" id="file-input" required>                                                                                                                                                                      │
│    50 +           </div>                                                                                                                                                                                                                                   │
│    51 +         </form>                                                                                                                                                                                                                                    │
│    52 +       </div>                                                                                                                                                                                                                                       │
│    53 +       <div class="modal-footer">                                                                                                                                                                                                                   │
│    54 +         <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>                                                                                                                                                     │
│    55 +         <button type="button" class="btn btn-primary" id="upload-button">Upload</button>                                                                                                                                                           │
│    56 +       </div>                                                                                                                                                                                                                                       │
│    57 +     </div>                                                                                                                                                                                                                                         │
│    58 +   </div>                                                                                                                                                                                                                                           │
│    59 + </div>                                                                                                                                                                                                                                             │
│    60   {% endblock %}                                                                                                                                                                                                                                     │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
✦ Modal de upload adicionado. Agora, no backend, atualizarei app/routes/files.py com a rota POST /files/upload, protegida por login, para salvar arquivos em um diretório de usuário específico, usando secure_filename e registrando no banco de dados. Também
  adicionarei a variável UPLOAD_FOLDER ao config.py e garantirei que a pasta de uploads seja criada na inicialização do aplicativo em app/__init__.py. Começarei configurando o UPLOAD_FOLDER.
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ ✓  Edit config.py: class Config:... => class Config:...                                                                                                                                                                                                    │
│                                                                                                                                                                                                                                                            │
│     9   SQLALCHEMY_DATABASE_URI = os.environ.get('DATABASE_URL') or \                                                                                                                                                                                      │
│    10       'sqlite:///' + os.path.join(basedir, 'app.db')                                                                                                                                                                                                 │
│    11   SQLALCHEMY_TRACK_MODIFICATIONS = False                                                                                                                                                                                                             │
│    12 + UPLOAD_FOLDER = os.path.join(basedir, 'instance', 'uploads')                                                                                                                                                                                       │
│    13                                                                                                                                                                                                                                                      │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
✦ UPLOAD_FOLDER adicionado. Agora, crio o endpoint de upload de arquivos em app/routes/files.py.
╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ ✓  Edit app/routes/files.py: from flask import Blueprint, j... => from flask import Blueprint, j...                                                                                                                                                        │
│                                                                                                                                                                                                                                                            │
│     1 - from flask import Blueprint, jsonify, request                                                                                                                                                                                                      │
│     1 + from flask import Blueprint, jsonify, request, current_app                                                                                                                                                                                         │
│     2   from flask_login import login_required, current_user                                                                                                                                                                                               │
│     3 + from werkzeug.utils import secure_filename                                                                                                                                                                                                         │
│     4   from app.models import File                                                                                                                                                                                                                        │
│     5   from app import db                                                                                                                                                                                                                                 │
│     6 + import os                                                                                                                                                                                                                                          │
│     7                                                                                                                                                                                                                                                      │
│     8   bp = Blueprint('files', __name__)                                                                                                                                                                                                                  │
│     9                                                                                                                                                                                                                                                      │
│    ═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════ │
│    18       items = [item.to_dict() for item in query.all()]                                                                                                                                                                                               │
│    19                                                                                                                                                                                                                                                      │
│    20       return jsonify(items)                                                                                                                                                                                                                          │
│    21 +                                                                                                                                                                                                                                                    │
│    22 + @bp.route('/files/upload', methods=['POST'])                                                                                                                                                                                                       │
│    23 + @login_required                                                                                                                                                                                                                                    │
│    24 + def upload_file():                                                                                                                                                                                                                                 │
│    25 +     if 'file' not in request.files:                                                                                                                                                                                                                │
│    26 +         return jsonify({'error': 'No file part'}), 400                                                                                                                                                                                             │
│    27 +                                                                                                                                                                                                                                                    │
│    28 +     file = request.files['file']                                                                                                                                                                                                                   │
│    29 +     if file.filename == '':                                                                                                                                                                                                                        │
│    30 +         return jsonify({'error': 'No selected file'}), 400                                                                                                                                                                                         │
│    31 +                                                                                                                                                                                                                                                    │
│    32 +     parent_id = request.form.get('parent_id', default=None, type=int)                                                                                                                                                                              │
│    33 +                                                                                                                                                                                                                                                    │
│    34 +     if file:                                                                                                                                                                                                                                       │
│    35 +         filename = secure_filename(file.filename)                                                                                                                                                                                                  │
│    36 +                                                                                                                                                                                                                                                    │
│    37 +         # Create user-specific upload path                                                                                                                                                                                                         │
│    38 +         user_upload_path = os.path.join(current_app.config['UPLOAD_FOLDER'], f'user_{current_user.id}')                                                                                                                                            │
│    39 +         os.makedirs(user_upload_path, exist_ok=True)                                                                                                                                                                                               │
│    40 +                                                                                                                                                                                                                                                    │
│    41 +         file_path = os.path.join(user_upload_path, filename)                                                                                                                                                                                       │
│    42 +         file.save(file_path)                                                                                                                                                                                                                       │
│    43 +                                                                                                                                                                                                                                                    │
│    44 +         # Create new file record in DB                                                                                                                                                                                                             │
│    45 +         new_file = File(                                                                                                                                                                                                                           │
│    46 +             filename=filename,                                                                                                                                                                                                                     │
│    47 +             owner_id=current_user.id,                                                                                                                                                                                                              │
│    48 +             parent_id=parent_id,                                                                                                                                                                                                                   │
│    49 +             is_folder=False                                                                                                                                                                                                                        │
│    50 +         )                                                                                                                                                                                                                                          │
│    51 +         db.session.add(new_file)                                                                                                                                                                                                                   │
│    52 +         db.session.commit()                                                                                                                                                                                                                        │
│    53 +                                                                                                                                                                                                                                                    │
│    54 +         return jsonify(new_file.to_dict()), 201                                                                                                                                                                                                    │
│    55 +                                                                                                                                                                                                                                                    │
│    56 +     return jsonify({'error': 'File upload failed'}), 500                                                                                                                                                                                           │
╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
